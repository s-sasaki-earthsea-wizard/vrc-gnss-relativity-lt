<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>GPSと2つの相対論 〜人工衛星の時計は運動によって遅れ、地球の重力によって進む〜</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/sky.css">
		
		<!-- Add KaTeX CSS and JS -->
		<link rel="stylesheet" href="plugin/math/katex.min.css">
		<script src="plugin/math/katex.min.js"></script>
		<script src="plugin/math/math.js"></script>

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
		
		<link rel="stylesheet" href="styles/custom-style.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-markdown>

## GPSと2つの相対論
### 〜🛰️人工衛星の時計は運動によって遅れ🕐⤵️、地球の重力によって進む🕐⤴️〜

---

### 自己紹介

<div class="profile-container">
<div class="profile-left" data-markdown>

* さめ(meg-ssk)
* 🧑‍💻 フリーランスのソフトウェアエンジニア
* 得意分野:
	* 📸 コンピュータビジョン (画像認識/点群処理)
	* 🌍 空間情報処理 (地理情報/リモートセンシング)
	* ☁️ クラウドインフラ設計/IaC (AWS, GCP)
* [GitHub](https://github.com/s-sasaki-earthsea-wizard)
* [YouTube](https://www.youtube.com/@SyotaSasaki-EW)
* [Speaker Deck](https://speakerdeck.com/syotasasaki593876)
</div>

<div class="profile-right">

<img src="assets/images/avatar.png" alt="avatar" height="350px" width="350px">

</div>
</div>

---

### 今日話すこと

*  GPSなどのGNSSはどうやって位置を測定しているのか？
  * 相対論効果を一切考慮しないケース (幾何光学)
  * 特殊相対論効果の影響
  * 一般相対論効果の影響

---

## 幾何光学による位置測定

---

### FOT (Flight of Time)による位置測定

* iPhoneのLiDARなどが代表例
* マイクロ波を発射して反射波を受信する
* 反射波の到着時間から距離を計算する

$$ \Delta t = \frac{2\Delta d}{c} $$

---

### 人工衛星による測位 (衛星が1つの時)

* 電磁波を送信して反射波を受信するまでの時間がわかる
* 衛星の位置がわかれば、その衛星からの距離がわかる
* 衛星が1つの時、その衛星中心とした球面上にいる
* 球面上の点は3つの自由度(半径、緯度と経度)を持つ

$$
\begin{cases}
x = r \cos \theta \sin \phi \\
y = r \sin \theta \sin \phi \\
z = r \cos \phi
\end{cases}
$$

---

### 人工衛星による測位 (衛星が2つの時)

* 衛星が2つの時、2つの球が得られる (ただしr1 + r2 < ||r1 - r2||)
* 2つの球の交線は円
* つまり円周上のどこかにいることがわかる
* 円周上の点は2つの自由度(半径と角度)を持つ

$$
\begin{cases}
x = r \cos \theta \\
y = r \sin \theta
\end{cases}
$$

---

### 人工衛星による測位 (衛星が3つの時)

* 衛星が3つの時、3つの球が得られる
* 円と球の交点は2点
* つまり、2つのどちらかにまで絞られる。
  * 自由度は1
* 地上のカーナビやスマホはこれで十分
  * 2つのうち地上に近い方を選ぶ

---

### 人工衛星による測位 (衛星が4つの時)

* 衛星が4つの時、4つの球が得られる
* 新しく追加された球は2つの交点のうち、1つのみを通る
* つまり、1つの点にまで絞られる
  * 自由度は0
* 航空機の精密測位には4つ目が必要

---

## 特殊相対論効果の影響

---

### 特殊相対論とは？

* 高速で運動する物体は時間が遅くなる

---

### 光速度不変の原理

* 光の速度は誰から見ても同じ
* 等速直線運動をする光源から出た光の速度は、光源の速度によらない
* しかし移動する光源AからB地点にまで光が到達する時間Aから見てもBから見ても同じ
* 観測者によって時間が伸び縮みしている

---

### Lorentz変換

* 観測者と光源の相対速度によって時間が伸び縮みする

$$
\begin{cases}
t' = \gamma (t - \frac{v}{c^2}x) \\
x' = \gamma (x - vt)
\end{cases}
$$

ここで:
- $t$: 観測者から見た時間
- $t'$: 光源から見た時間
- $x$: 観測者から見た位置
- $x'$: 光源から見た位置
- $v$: 光源の速度
- $c$: 光速

---

### Lorentzブースト

$$ \gamma = \frac{1}{\sqrt{1-v^2/c^2}} $$

---

### 特殊相対論効果の影響

* 静止人工衛星の速度
  * 静止衛星の高度は約36000km
  * 静止衛星の速度は約3.9km/s
* 特殊相対論効果による時間の遅れ
  * 静止衛星の時間は地上の時間より約7.2μs/日遅れる

---

## 一般相対論効果の影響

---

### 一般相対論とは？

* 重力と時空の物理学

---

### 重力とは？

* ニュートン力学
  * 重力は物体間の引力
  * 重力は物体の質量に比例する
  * 重力は物体間の距離に反比例する
* 一般相対論
  * 重力は時空の歪み
  * 質量を持つ物質によって時空が曲がる
  * この時空の曲がりを我々は重力として観測する
  * 時空の曲がりはEinstein方程式で記述される

---

### Einstein方程式

$$ R_{\mu\nu} - \frac{1}{2}g_{\mu\nu}R = \frac{8\pi G}{c^4}T_{\mu\nu} $$

* 左辺は時空の曲がり
* 右辺は物質の分布
* 一般的には解析的に解けない


---

## <span style="text-transform: none;">Schwarzschild解</span>

* 最も簡単かつ有名なEinstein方程式の解

$$ ds^2 = -\left(1-\frac{2GM}{c^2r}\right)c^2dt^2 + \left(1-\frac{2GM}{c^2r}\right)^{-1}dr^2 + r^2(d\theta^2 + \sin^2\theta d\phi^2) $$

ここで:
- $G$: 万有引力定数
- $M$: 中心天体の質量
- $c$: 光速
- $r$: 中心からの距離
- $t$: 時間座標
- $\theta, \phi$: 角度座標

---

### Schwarzschild解の特徴

* 球対称かつ静的な時空
* 物質は角運動量を持たない (自転しない)
* 物質は電荷を持たない

---

### 地球の重力場

* 地球の重力場はSchwarzschild解で近似できる
* 地球はほぼ球対称 (実際は楕円体)
* 地球の自転は光速に比べて非常に遅い
* 地球は電気的にほぼ中性 (天体外に電場を張らない)

---

### Schwarzschild解の弱重力場近似

* 弱重力場ではSchwarzschild解はニュートン力学に一致する
* 弱重力場では重力は遠方ではNewton力学で記述できる
* 地球の重力場は弱いので、Schwarzschild解の弱重力場近似を使う

$$ \frac{1}{2} \left( \frac{dr}{dt} \right)^2 = \frac{2GM}{r} - \frac{2GM}{r_s} $$

ここで:
- $G$: 万有引力定数
- $M$: 中心天体の質量
- $r$: 中心からの距離
- $t$: 時間座標
- $r_s$: 中心天体のSchwarzschild半径

---

### 弱重力場のSchwarzschild計量の空間成分

$$ ds^2 = \left(1-\frac{2GM}{c^2r}\right)^{-1}dr^2 \simeq \left(1+\frac{GM}{c^2r}\right)dr^2 $$

---

### 重力赤方偏移

* 重力による時間の遅れは重力赤方偏移によって記述できる

$$ \frac{\lambda_o}{\lambda_e} = \sqrt{\frac{1-\frac{GM}{c^2r_e}}{1-\frac{GM}{c^2r_o}}} $$

ここで:
- $\lambda_o$: 観測者での波長
- $\lambda_e$: 光源での波長
- $G$: 万有引力定数
- $M$: 中心天体の質量
- $c$: 光速

---

### 重力赤方偏移と時間の進み

* 重力赤方偏移によって光の波長が変化する
* しかし光速度は不変
* つまり、光の波長が変化するということは、時間の遅れが生じるということ！

---

### 重力赤方偏移による時間の進み

* 地球の半径をr_e, 人工衛星の高度をhとする
* 地球の中心から人工衛星までの距離はr_e + h
* 地球の中心から地表までの距離はr_e
* 重力赤方偏移による時間のズレは

$$ \frac{\Delta t}{t} = \frac{\lambda_o}{\lambda_e} - 1 = \sqrt{\frac{1-\frac{GM}{c^2 r_e}}{1-\frac{GM}{c^2(r_e+h)}}} - 1 $$

* 地表面に比べて衛星軌道上は重力が弱いので、人工衛星の時間は地表面よりも早く進む

---

### 重力赤方偏移でどの程度時間が進む？

* 静止衛星の高度は約36000km
* 地球の半径は約6378km
* 重力赤方偏移による時間のズレは

$$ \frac{\Delta t}{t} = \frac{\lambda_o}{\lambda_e} - 1 = \sqrt{\frac{1-\frac{GM}{c^2r_e}}{1-\frac{GM}{c^2r_o}}} - 1 \simeq 25.5 \mu \text{s/day} $$

* 重力赤方偏移による時間のズレは約25.5μs/日

---

### 静止衛星と地上の時間のずれ

* 特殊相対論効果によって静止衛星の時間は地上の時間より約7.2μs/日遅れる
* 一般相対論効果によって静止衛星の時間は地上の時間より約25.5μs/日進む
* つまり、静止衛星の時間は地上の時間より約18.3μs/日進む

---

### もし補正をしないとどうなる？

* 静止衛星の時間は地上の時間より約18.3μs/日進む
* 光速は3x10^8 m/s

$$ \Delta d = c \Delta t = 3 \times 10^8 \times 18.3 \times 10^{-6} \simeq 7650 \text{m} $$

* つまり、1日で7.65kmずれる！

---

### 実際の運用

* 各衛星の高度や軌道傾斜角に応じて、時間の進み方が異なる
* そのため、GPS衛星の軌道に応じた時間の補正が必要
* 正確な時間補正を行い、正確な測位を行う

---

### まとめ

* GPSなどのGNSSの正確な測位には、特殊相対論と一般相対論の補正が必要
* 衛星は高速で運動しているため、特殊相対論による時間の遅れの補正が必要
* 地上と比べて衛星軌道の重力場は弱いため、一般相対論による時間の進みの補正が必要
* これらの補正を行うことで、GPSなどのGNSSの正確な測位が可能になる

				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				// KaTeXプラグインを追加
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX ]
			});
		</script>
	</body>
</html>
